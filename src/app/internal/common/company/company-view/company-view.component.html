<div class="m-t-6xl company-view">
    <card-template *ngIf="company">
        <div class="company-view-header-container flex-wrap m-b-l">
            <div class="title m-b-l">
                <div>
                    <h1>{{ company?.name }}</h1>
                    <div>
                        <small>
                            <span *ngIf="company.location?.length > 3"
                                >{{ company.location }}
                            </span>
                            <span *ngIf="company.calculatedLocation"
                                >(Weighted: {{ company.calculatedLocation }})
                            </span>
                        </small>
                    </div>
                </div>
            </div>
            <div class="kpis m-t-l">
                <div class="kpi-card-main">
                    <app-kpi-card
                        [name]="'3mo h/c Δ'"
                        [value]="company.mavgTrend"
                        [percentageMode]="true"
                        [isBig]="true"
                    ></app-kpi-card>
                </div>
                <div class="kpi-card-main">
                    <app-kpi-card
                        [name]="'12mo h/c Δ'"
                        [value]="company.maTrend"
                        [percentageMode]="true"
                        [isBig]="true"
                    ></app-kpi-card>
                </div>
                <div class="kpi-card-main">
                    <app-kpi-card
                        [name]="'Robscore'"
                        [value]="company.robscore"
                        [isBig]="true"
                    ></app-kpi-card>
                </div>
                <div class="kpi-card-main">
                    <app-kpi-card
                        [name]="'EduScore'"
                        [value]="company.educationScore"
                        [isBig]="true"
                    ></app-kpi-card>
                </div>
            </div>
        </div>
        <div>
            <div *ngIf="company.tags !== ''">
                <small
                    >Tags: <em>{{ company.tags }}</em></small
                >
            </div>
            <div class="m-t m-b">
                <app-company-links [company]="company"></app-company-links>
            </div>
        </div>
        <div class="m-b-xl">
            <app-chart [company]="company"></app-chart>
        </div>
        <app-company-details-by-cards
            [company]="company"
        ></app-company-details-by-cards>
        <div class="capsule-container flex-wrap">
            <div class="company-info p-r-xl m-t-xl">
                <app-capsule-details
                    [capsuleDetails]="capsuleDetails$ | async"
                ></app-capsule-details>
            </div>
            <div class="notes m-t-xl">
                <div *ngIf="capsuleDetails$ | async as capsuleDetails">
                    <div class="flex-container p-b-xl">
                        <div>
                            <app-last-contact
                                [capsuleDetails]="capsuleDetails"
                            ></app-last-contact>
                        </div>
                        <div class="text-right">
                            <button
                                mat-raised-button
                                class="mat-primary"
                                type="button"
                            >
                                Add new note
                            </button>
                        </div>
                    </div>
                </div>
                <app-capsule-notes
                    [capsuleNotes]="capsuleNotes$ | async"
                ></app-capsule-notes>
                <div class="text-right">
                    <button mat-button class="" type="button">
                        Debug
                    </button>
                </div>
            </div>
        </div>
    </card-template>
    <mat-spinner *ngIf="!company" class="m-t-2xl spinner"></mat-spinner>
</div>
