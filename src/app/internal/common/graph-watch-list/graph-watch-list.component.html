<div class="m-t-6xl">
  <div class="m-t-3xl">
    <div class="p-l-l p-r-l m-b-xl">

      <form novalidate [formGroup]="form">
        <div class="flex-container text-right">
          <div>
            <mat-form-field class="regular-field m-r-l">
              <mat-select placeholder="Cities" formControlName="cities" multiple (selectionChange)="updateCompanyValuesToDisplay()">
                <mat-option *ngFor="let city of cities" [value]="city">
                  {{ city }}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <mat-form-field class="regular-field">
              <mat-select placeholder="Tags" formControlName="tags" multiple (selectionChange)="updateCompanyValuesToDisplay()">
                <mat-option *ngFor="let tag of tags" [value]="tag">
                  {{ tag }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>
        <div class="text-right m-t">
          <small>Count {{ filteredCompanyValuesCount }}</small>
        </div>
      </form>

      <mat-accordion displayMode="flat" multi class="mat-table m-t-l">
        <section matSort class="mat-elevation-z2 mat-header-row">
          <span class="mat-header-cell" mat-sort-header="name">Name</span>
          <span class="mat-header-cell" mat-sort-header="CRM">CRM</span>
          <span class="mat-header-cell" mat-sort-header="maxEmp">Max H/C</span>
          <span class="mat-header-cell" mat-sort-header="mavgTrend">3 mo Accel%</span>
          <span class="mat-header-cell" mat-sort-header="weight">Weight</span>
          <span class="mat-header-cell" mat-sort-header="maTrend">YoY H/C Gain%</span>
          <span class="mat-header-cell" mat-sort-header="eng">Eng H/C</span>
          <span class="mat-header-cell" mat-sort-header="sales">Sales H/C</span>
          <span class="mat-header-cell" mat-sort-header="percentEng">H/C Eng%</span>
          <span class="mat-header-cell" mat-sort-header="percentSales">H/C Sales%</span>
          <span class="mat-header-cell" mat-sort-header="growth6Eng">6mo Eng Growth%</span>
          <span class="mat-header-cell" mat-sort-header="growth6Sales">6mo Sales Growth%</span>
          <span class="mat-header-cell" mat-sort-header="location">HQ</span>
          <span class="mat-header-cell" mat-sort-header="cbLastFundingDate">Since last rnd</span>
          <span class="mat-header-cell" mat-sort-header="cbLastSeries">Last round</span>
          <span class="mat-header-cell" mat-sort-header="cbLastPremoneyUsd">Valuation</span>
        </section>

        <mat-expansion-panel [expanded]="true" *ngFor="let cv of companyValuesToDisplay$ | async">
          <mat-expansion-panel-header class="mat-row">
            <span class="mat-cell">
              <a href="{{cv.linkedinUrl}}" target="_blank">{{cv.name}}</a>
            </span>
            <span class="mat-cell">
              <a href="{{cv.crmLink}}" target="_blank">CRM</a>
            </span>
            <span class="mat-cell">{{cv.maxEmp}}</span>
            <span class="mat-cell">{{cv.mavgTrend}}%</span>
            <span class="mat-cell">{{cv.weight}}</span>
            <span class="mat-cell">{{cv.maTrend}}%</span>
            <span class="mat-cell">{{cv.eng}}</span>
            <span class="mat-cell">{{cv.sales}}</span>
            <span class="mat-cell">{{cv.percentEng}}%</span>
            <span class="mat-cell">{{cv.percentSales}}%</span>
            <span class="mat-cell">{{cv.growth6Eng}}%</span>
            <span class="mat-cell">{{cv.growth6Sales}}%</span>
            <span class="mat-cell">{{cv.location}}</span>
            <span class="mat-cell">{{cv.cbLastFundingDate}}</span>
            <span class="mat-cell">{{cv.cbLastSeries}}</span>
            <span class="mat-cell">{{cv.cbLastPremoneyUsd}}</span>
          </mat-expansion-panel-header>
          <div class="m-b-l"><small>Tags: <em>{{cv.tags}}</em></small></div>
          <div>
            <a href="{{cv.graphBig}}" target="_blank"><img width="100%" src="{{cv.graphBig}}"></a>
          </div>
          <!--<div><small><pre>{{c | json}}</pre></small></div>-->
        </mat-expansion-panel>

      </mat-accordion>
    </div>
  </div>
</div>

